<section class="w-full lg:col-span-2">
  <div class="bg-white rounded-2xl shadow-md p-6 space-y-5 max-h-[70vh] overflow-y-auto">
    <header class="flex items-center justify-between sticky top-0 bg-white z-10 pb-2 border-b border-gray-200">
      <h2 class="text-2xl font-bold text-gray-900 flex items-center gap-2">
        <span class="material-symbols-outlined text-blue-600">fact_check</span>
        Student Attendance
      </h2>
      <button id="openAttendanceModal" class="text-sm px-3 py-1.5 rounded-md bg-blue-50 text-blue-700 hover:bg-blue-100 transition-all">
        View Full List
      </button>
    </header>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      {% for student in students %}
      <div class="student-card p-4 bg-gray-50 rounded-xl border border-gray-200 hover:shadow-md transition-all duration-200"
           data-grade="{{ student.grade_level }}"
           data-section="{{ student.section }}"
           data-student-id="{{ student.student_id }}">
        <div class="flex justify-between items-start">
          <div>
            <p class="font-semibold text-gray-900">
              {{ student.first_name }}{% if student.middle_initial %} {{ student.middle_initial }}.{% endif %} {{ student.last_name }}
            </p>
            <p class="text-xs text-gray-500">{{ student.student_id }}</p>
          </div>
          <span class="status-badge text-xs font-medium px-2 py-1 rounded-full" data-status="{{ student.status or 'Absent' }}">
            {{ student.status or 'Absent' }}
          </span>
        </div>

        <div class="mt-3">
          <label class="block text-xs text-gray-500 mb-1">Update Status</label>
          <select class="status-select w-full px-3 py-1.5 rounded-lg text-sm border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                  data-student-id="{{ student.student_id }}"
                  data-status="{{ student.status or 'Absent' }}">
            <option value="Absent" {% if student.status == 'Absent' or not student.status %}selected{% endif %}>Absent</option>
            <option value="Present" {% if student.status == 'Present' %}selected{% endif %}>Present</option>
            <option value="Late" {% if student.status == 'Late' %}selected{% endif %}>Late</option>
            <option value="Excused" {% if student.status == 'Excused' %}selected{% endif %}>Excused</option>
          </select>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>